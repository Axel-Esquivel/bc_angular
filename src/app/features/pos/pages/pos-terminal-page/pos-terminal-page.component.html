<div class="pos-layout">
  <div class="products-panel">
    <h3>BÃºsqueda de productos</h3>
    <form [formGroup]="searchForm" class="search-form" (ngSubmit)="searchProducts()">
      <input pInputText formControlName="search" placeholder="Nombre o SKU" />
      <p-button type="submit" label="Buscar" icon="pi pi-search" [disabled]="searchForm.invalid"></p-button>
    </form>

    <p-table [value]="productResults" responsiveLayout="scroll">
      <ng-template pTemplate="header">
        <tr>
          <th>Producto</th>
          <th>Precio</th>
          <th></th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-product>
        <tr>
          <td>{{ product.name }}</td>
          <td>{{ product.price | currency:'USD' }}</td>
          <td>
            <p-button label="Agregar" icon="pi pi-plus" size="small" (onClick)="addToCart(product)"></p-button>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>

  <div class="cart-panel">
    <h3>Carrito</h3>
    <p-table [value]="cartLines" responsiveLayout="scroll">
      <ng-template pTemplate="header">
        <tr>
          <th>Producto</th>
          <th>Cantidad</th>
          <th>Precio</th>
          <th>Subtotal</th>
          <th></th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-line>
        <tr>
          <td>{{ line.productName }}</td>
          <td>
            <p-inputNumber
              [ngModel]="line.quantity"
              (ngModelChange)="updateQuantity(line, $event || 0)"
              [min]="1"
            ></p-inputNumber>
          </td>
          <td>{{ line.unitPrice | currency:'USD' }}</td>
          <td>{{ line.subtotal | currency:'USD' }}</td>
          <td>
            <p-button icon="pi pi-trash" severity="danger" size="small" (onClick)="removeLine(line)"></p-button>
          </td>
        </tr>
      </ng-template>
    </p-table>

    <div class="totals">
      <div class="total-row">
        <span>Total</span>
        <strong>{{ subtotal | currency:'USD' }}</strong>
      </div>
      <p-button label="Cobrar" icon="pi pi-check" (onClick)="checkout()" [disabled]="!cartLines.length"></p-button>
    </div>
  </div>
</div>
