<section [class.bc-page-center]="mode === 'page'" [class.bc-dialog-wrapper]="mode === 'dialog'">
  <p-card header="Crear organizacion" class="bc-card">
    <p-stepper [(value)]="activeStep">
      <p-step-list>
        <p-step [value]="1">Organizacion</p-step>
        <p-step [value]="2">Paises y Monedas</p-step>
        <p-step [value]="3">Companias por Pais</p-step>
        <p-step [value]="4">Empresas por Compania</p-step>
      </p-step-list>

      <p-step-panels>
        <p-step-panel [value]="1">
          <ng-template #content>
            <app-org-step-organization-form
              [isSubmitting]="isSubmittingOrg"
              [organizationId]="createdOrganizationId"
              [existingOrganizations]="existingOrganizations"
              (created)="onOrganizationCreated($event)"
              (validChange)="onStep1ValidChange($event)"
            ></app-org-step-organization-form>
          </ng-template>
        </p-step-panel>

        <p-step-panel [value]="2">
          <ng-template #content>
            <app-org-step-countries-currencies
              [organizationId]="createdOrganizationId"
              (readyChange)="onStep2ReadyChange($event)"
            ></app-org-step-countries-currencies>
          </ng-template>
        </p-step-panel>

        <p-step-panel [value]="3">
          <ng-template #content>
            <app-org-step-companies-by-country
              [organizationId]="createdOrganizationId"
              (readyChange)="onStep3ReadyChange($event)"
            ></app-org-step-companies-by-country>
          </ng-template>
        </p-step-panel>

        <p-step-panel [value]="4">
          <ng-template #content>
            <app-org-step-branches-by-company
              [organizationId]="createdOrganizationId"
              (finished)="onStep4Finished()"
            ></app-org-step-branches-by-company>
          </ng-template>
        </p-step-panel>
      </p-step-panels>
    </p-stepper>

    <div class="bc-step-actions">
      <p-button
        label="Atras"
        severity="secondary"
        text
        [disabled]="activeStep === 1"
        (onClick)="goBack()"
      ></p-button>

      <p-button
        *ngIf="activeStep < 4"
        label="Siguiente"
        [disabled]="
          (activeStep === 1 && (!step1Valid || isSubmittingOrg)) ||
          (activeStep === 2 && !step2Ready) ||
          (activeStep === 3 && !step3Ready)
        "
        [loading]="activeStep === 1 && isSubmittingOrg"
        (onClick)="goNext()"
      ></p-button>

      <p-button
        *ngIf="activeStep === 4"
        label="Finalizar"
        [disabled]="!step4Ready"
        (onClick)="finish()"
      ></p-button>
    </div>
  </p-card>
</section>
<p-confirmDialog></p-confirmDialog>
