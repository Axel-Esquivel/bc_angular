<p-toolbar>
  <ng-template pTemplate="start">
    <div class="toolbar-title">
      <span>Proveedores</span>
    </div>
  </ng-template>
  <ng-template pTemplate="end">
    <p-button label="Nuevo" icon="pi pi-plus" (onClick)="openCreate()"></p-button>
  </ng-template>
</p-toolbar>

<div class="providers-table">
  <p-table [value]="providers" [loading]="loading" dataKey="id" [rows]="20" [paginator]="providers.length > 20">
    <ng-template pTemplate="header">
      <tr>
        <th>Nombre</th>
        <th>NIT</th>
        <th>D&iacute;as cr&eacute;dito</th>
        <th>L&iacute;mite cr&eacute;dito</th>
        <th>Estado</th>
        <th class="actions">Acciones</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-provider>
      <tr>
        <td>{{ provider.name }}</td>
        <td>{{ provider.nit || '—' }}</td>
        <td>{{ provider.creditDays ?? '—' }}</td>
        <td>{{ provider.creditLimit ?? '—' }}</td>
        <td>{{ resolveStatusLabel(provider.status) }}</td>
        <td class="actions">
          <p-button
            icon="pi pi-pencil"
            label="Editar"
            size="small"
            severity="secondary"
            (onClick)="openEdit(provider)"
          ></p-button>
        </td>
      </tr>
    </ng-template>
    <ng-template pTemplate="emptymessage">
      <tr>
        <td colspan="6">
          {{ contextMissing ? 'Selecciona organizaci&oacute;n y empresa para ver proveedores.' : 'Sin proveedores.' }}
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>

<p-dialog
  [header]="editingProvider ? 'Editar proveedor' : 'Nuevo proveedor'"
  [(visible)]="dialogVisible"
  [modal]="true"
  [closable]="true"
  [draggable]="false"
  [style]="{ width: '520px' }"
>
  <app-provider-form
    [provider]="editingProvider ?? undefined"
    (save)="onFormSave($event)"
    (cancel)="closeDialog()"
  ></app-provider-form>
</p-dialog>
